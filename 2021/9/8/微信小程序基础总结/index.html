<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>微信小程序基础总结</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" href="/favicons/favicon.png">
    <link rel="stylesheet" href="https://fonts.font.im/css?family=Lobster|Satisfy">
    <link rel="preload" crossorigin="anonymous" href="//at.alicdn.com/t/font_2949371_6nhphjuvnzc.woff2" as="font" type="font/woff2">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_2949371_6nhphjuvnzc.css">
    <link rel="preload" crossorigin="anonymous" href="//at.alicdn.com/t/font_2953551_u612koyhj6.woff2" as="font" type="font/woff2">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_2953551_u612koyhj6.css">
    <script charset="utf-8" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async="true"></script>
    <meta name="description" content="Just for fun!">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <link rel="preload" href="/assets/css/0.styles.709f0a23.css" as="style"><link rel="preload" href="/assets/js/app.f6b2750d.js" as="script"><link rel="preload" href="/assets/js/6.992087fc.js" as="script"><link rel="preload" href="/assets/js/1.bd8257ab.js" as="script"><link rel="preload" href="/assets/js/82.3be4b911.js" as="script"><link rel="prefetch" href="/assets/js/10.a4ac7942.js"><link rel="prefetch" href="/assets/js/100.334f7041.js"><link rel="prefetch" href="/assets/js/101.fbd706a6.js"><link rel="prefetch" href="/assets/js/102.928bd9cf.js"><link rel="prefetch" href="/assets/js/103.0e507560.js"><link rel="prefetch" href="/assets/js/104.677d6026.js"><link rel="prefetch" href="/assets/js/11.a88e960f.js"><link rel="prefetch" href="/assets/js/12.82f24d68.js"><link rel="prefetch" href="/assets/js/13.aa0330ff.js"><link rel="prefetch" href="/assets/js/14.c5724fbc.js"><link rel="prefetch" href="/assets/js/15.c41a9191.js"><link rel="prefetch" href="/assets/js/16.b14c2bfe.js"><link rel="prefetch" href="/assets/js/17.6bd551a7.js"><link rel="prefetch" href="/assets/js/18.4f1f5177.js"><link rel="prefetch" href="/assets/js/19.f06a202c.js"><link rel="prefetch" href="/assets/js/20.907e26c8.js"><link rel="prefetch" href="/assets/js/21.dfdb6fc0.js"><link rel="prefetch" href="/assets/js/22.3c22b8fb.js"><link rel="prefetch" href="/assets/js/23.ba3747ff.js"><link rel="prefetch" href="/assets/js/24.07436c85.js"><link rel="prefetch" href="/assets/js/25.f117c5b2.js"><link rel="prefetch" href="/assets/js/26.fd9683ac.js"><link rel="prefetch" href="/assets/js/27.90ad260b.js"><link rel="prefetch" href="/assets/js/28.e5a99905.js"><link rel="prefetch" href="/assets/js/29.7f97fe08.js"><link rel="prefetch" href="/assets/js/3.6131e7eb.js"><link rel="prefetch" href="/assets/js/30.c5ed064d.js"><link rel="prefetch" href="/assets/js/31.c461afd1.js"><link rel="prefetch" href="/assets/js/32.8eebdde2.js"><link rel="prefetch" href="/assets/js/33.03d4eff8.js"><link rel="prefetch" href="/assets/js/34.3928d533.js"><link rel="prefetch" href="/assets/js/35.ef8efb45.js"><link rel="prefetch" href="/assets/js/36.83819fce.js"><link rel="prefetch" href="/assets/js/37.6d59eda5.js"><link rel="prefetch" href="/assets/js/38.a4afb281.js"><link rel="prefetch" href="/assets/js/39.43918783.js"><link rel="prefetch" href="/assets/js/4.b19c5430.js"><link rel="prefetch" href="/assets/js/40.d580eb3a.js"><link rel="prefetch" href="/assets/js/41.b577c732.js"><link rel="prefetch" href="/assets/js/42.981612e9.js"><link rel="prefetch" href="/assets/js/43.2885ecf0.js"><link rel="prefetch" href="/assets/js/44.22787400.js"><link rel="prefetch" href="/assets/js/45.7723d406.js"><link rel="prefetch" href="/assets/js/46.d928e9cd.js"><link rel="prefetch" href="/assets/js/47.f85996d5.js"><link rel="prefetch" href="/assets/js/48.6c8717ee.js"><link rel="prefetch" href="/assets/js/49.3c5e8dd4.js"><link rel="prefetch" href="/assets/js/5.2622ab97.js"><link rel="prefetch" href="/assets/js/50.92a73ca7.js"><link rel="prefetch" href="/assets/js/51.80a48043.js"><link rel="prefetch" href="/assets/js/52.c9bf257c.js"><link rel="prefetch" href="/assets/js/53.018ac1d8.js"><link rel="prefetch" href="/assets/js/54.a89e7420.js"><link rel="prefetch" href="/assets/js/55.d3aaddea.js"><link rel="prefetch" href="/assets/js/56.e9a7f02b.js"><link rel="prefetch" href="/assets/js/57.3f40c7b1.js"><link rel="prefetch" href="/assets/js/58.ad13bdb8.js"><link rel="prefetch" href="/assets/js/59.e269e085.js"><link rel="prefetch" href="/assets/js/60.0e9131e2.js"><link rel="prefetch" href="/assets/js/61.cc482820.js"><link rel="prefetch" href="/assets/js/62.a2e07666.js"><link rel="prefetch" href="/assets/js/63.7ddbd27f.js"><link rel="prefetch" href="/assets/js/64.01d97934.js"><link rel="prefetch" href="/assets/js/65.ec223303.js"><link rel="prefetch" href="/assets/js/66.1e481a1f.js"><link rel="prefetch" href="/assets/js/67.464c9e1a.js"><link rel="prefetch" href="/assets/js/68.de1774cb.js"><link rel="prefetch" href="/assets/js/69.b9d57c0d.js"><link rel="prefetch" href="/assets/js/7.74b5cc39.js"><link rel="prefetch" href="/assets/js/70.3711e0ce.js"><link rel="prefetch" href="/assets/js/71.767e8f35.js"><link rel="prefetch" href="/assets/js/72.a53a1b45.js"><link rel="prefetch" href="/assets/js/73.bee69c94.js"><link rel="prefetch" href="/assets/js/74.7a7adeff.js"><link rel="prefetch" href="/assets/js/75.6c3a8090.js"><link rel="prefetch" href="/assets/js/76.d1ae5729.js"><link rel="prefetch" href="/assets/js/77.5c3a3781.js"><link rel="prefetch" href="/assets/js/78.00f78c3d.js"><link rel="prefetch" href="/assets/js/79.7411c161.js"><link rel="prefetch" href="/assets/js/8.3a17ca06.js"><link rel="prefetch" href="/assets/js/80.e68cc1e1.js"><link rel="prefetch" href="/assets/js/81.f6a47abe.js"><link rel="prefetch" href="/assets/js/83.a6f2eb0b.js"><link rel="prefetch" href="/assets/js/84.50cf6623.js"><link rel="prefetch" href="/assets/js/85.e398d0f1.js"><link rel="prefetch" href="/assets/js/86.c4379b40.js"><link rel="prefetch" href="/assets/js/87.d388ea25.js"><link rel="prefetch" href="/assets/js/88.a27b91e6.js"><link rel="prefetch" href="/assets/js/89.4bfb06f1.js"><link rel="prefetch" href="/assets/js/9.9dcd8d7c.js"><link rel="prefetch" href="/assets/js/90.a020fc84.js"><link rel="prefetch" href="/assets/js/91.f8555e11.js"><link rel="prefetch" href="/assets/js/92.c390150d.js"><link rel="prefetch" href="/assets/js/93.3d51d66e.js"><link rel="prefetch" href="/assets/js/94.583e865f.js"><link rel="prefetch" href="/assets/js/95.a3c88640.js"><link rel="prefetch" href="/assets/js/96.2f0f983e.js"><link rel="prefetch" href="/assets/js/97.dfd7a5e2.js"><link rel="prefetch" href="/assets/js/98.8c9c7dd6.js"><link rel="prefetch" href="/assets/js/99.c4482f1c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.709f0a23.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="animate__animated animate__fadeIn animate__slow container"><div class="header-wrap" data-v-bc840c6a><div class="header page" data-v-bc840c6a><div class="left" data-v-bc840c6a><div class="head-title" data-v-bc840c6a></div> <div class="nav" data-v-bc840c6a></div></div> <div class="right" data-v-bc840c6a><div class="search-box" data-v-bc840c6a><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></div> <div class="page post-page"><div class="title"><div class="post-title">微信小程序基础总结</div></div> <div class="info"><div class="tags"><a class="tag" data-v-5095c9bc>小程序</a></div> <div class="author">KMS Woo</div> <div class="date">2021-9-8</div> <div class="count" style="display:;"><span id="busuanzi_value_page_pv"></span> <span>views</span></div></div> <div class="post-content"><div class="content__default"><p>关于微信小程序开发基础知识点的总结。</p> <h2 id="小程序代码构成"><a href="#小程序代码构成" class="header-anchor">#</a> 小程序代码构成</h2> <ul><li><p><code>.json</code> 后缀的 <code>JSON</code> 配置文件</p></li> <li><p><code>.wxml</code> 后缀的 <code>WXML</code> 模板文件</p></li> <li><p><code>.wxss</code> 后缀的 <code>WXSS</code> 样式文件</p></li> <li><p><code>.js</code> 后缀的 <code>JS</code> 脚本逻辑文件</p></li></ul> <h2 id="json-配置"><a href="#json-配置" class="header-anchor">#</a> JSON 配置</h2> <h3 id="app-json"><a href="#app-json" class="header-anchor">#</a> app.json</h3> <p>全局配置，包括了小程序的所有页面路径、界面表现、网络超时时间、底部 tab 等。</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;pages&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">&quot;pages/index/index&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;pages/logs/logs&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;window&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;backgroundTextStyle&quot;</span><span class="token operator">:</span><span class="token string">&quot;light&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;navigationBarBackgroundColor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#fff&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;navigationBarTitleText&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Weixin&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;navigationBarTextStyle&quot;</span><span class="token operator">:</span><span class="token string">&quot;black&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li><code>pages</code>字段 —— 用于描述当前小程序所有页面路径，这是为了让微信客户端知道当前你的小程序页面定义在哪个目录。</li> <li><code>window</code>字段 —— 定义小程序所有页面的顶部背景颜色，文字颜色定义等。</li></ol> <h3 id="工具配置-project-config-json"><a href="#工具配置-project-config-json" class="header-anchor">#</a> 工具配置 project.config.json</h3> <p>开发者工具的一些个性化配置，方便迅速还原开发现场。其他配置项细节可以参考文档 <a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/projectconfig.html" target="_blank" rel="noopener noreferrer">开发者工具的配置<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h3 id="页面配置-page-json"><a href="#页面配置-page-json" class="header-anchor">#</a> 页面配置 page.json</h3> <p>pages目录下每一个page文件夹下对应的json配置文件，比如index.json，logs.json。</p> <p>作用是用来个性化每个页面的配置，会覆盖全局配置。</p> <h2 id="wxml-模板"><a href="#wxml-模板" class="header-anchor">#</a> WXML 模板</h2> <p>本质上就是封装的组件</p> <p>更多详细的组件讲述参考下个章节 <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/framework.html" target="_blank" rel="noopener noreferrer">小程序的能力<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="wxss-样式"><a href="#wxss-样式" class="header-anchor">#</a> WXSS 样式</h2> <p><code>WXSS</code> 具有 <code>CSS</code> 大部分的特性，小程序在 <code>WXSS</code> 也做了一些扩充和修改。</p> <ol><li>新增了尺寸单位。在写 <code>CSS</code> 样式时，开发者需要考虑到手机设备的屏幕会有不同的宽度和设备像素比，采用一些技巧来换算一些像素单位。<code>WXSS</code> 在底层支持<strong>新的尺寸单位</strong> <code>rpx</code> ，开发者可以免去换算的烦恼，只要交给小程序底层来换算即可，由于换算采用的<strong>浮点数运算</strong>，所以运算结果会和预期结果有一点点偏差。</li> <li>提供了全局的样式和局部样式。和前边 <code>app.json</code>, <code>page.json</code> 的概念相同，你可以写一个 <code>app.wxss</code> 作为全局样式，会作用于当前小程序的所有页面，局部页面样式 <code>page.wxss</code> 仅对当前页面生效。</li> <li>此外 <code>WXSS</code> 仅支持部分 <code>CSS</code> 选择器</li></ol> <p>更详细的文档可以参考 <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxss.html" target="_blank" rel="noopener noreferrer">WXSS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。</p> <h3 id="rpx"><a href="#rpx" class="header-anchor">#</a> rpx</h3> <p>在WXSS中，引入了rpx（responsive pixel）尺寸单位。引用新尺寸单位的目的是，适配不同宽度的屏幕，开发起来更简单。</p> <p>小程序编译后，rpx会做一次px换算。换算是以375个物理像素为基准，也就是在一个宽度为375物理像素的屏幕下，1rpx = 1px。</p> <p>举个例子：iPhone6屏幕宽度为375px，共750个物理像素，那么1rpx = 375 / 750 px = 0.5px。</p> <table><thead><tr><th style="text-align:left;">设备</th> <th style="text-align:left;">rpx换算px (屏幕宽度/750)</th> <th style="text-align:left;">px换算rpx (750/屏幕宽度)</th></tr></thead> <tbody><tr><td style="text-align:left;">iPhone5</td> <td style="text-align:left;">1rpx = 0.42px</td> <td style="text-align:left;">1px = 2.34rpx</td></tr> <tr><td style="text-align:left;">iPhone6</td> <td style="text-align:left;">1rpx = 0.5px</td> <td style="text-align:left;">1px = 2.00rpx</td></tr> <tr><td style="text-align:left;">iPhone6s</td> <td style="text-align:left;">1rpx = 0.552px</td> <td style="text-align:left;">1px = 1.81rpx</td></tr></tbody></table> <h3 id="rpx-和-iphone-设计稿的关系"><a href="#rpx-和-iphone-设计稿的关系" class="header-anchor">#</a> rpx 和 iPhone 设计稿的关系</h3> <blockquote><p>官方建议：开发微信小程序时，设计师可以以iPhone6 作为视觉稿的标准，如果要根据iPhone6的设计稿，绘制小程序的页面，可以直接把单位 px 替换成 rpx 。例如：假设iPhone6设计稿上，要绘制一个宽高为 200px 的盒子，换算为 rpx为200rpx</p></blockquote> <h3 id="以iphone6为设计稿标准-单位-px-直接替换成-rpx的原因"><a href="#以iphone6为设计稿标准-单位-px-直接替换成-rpx的原因" class="header-anchor">#</a> 以iPhone6为设计稿标准，单位 px 直接替换成 rpx的原因</h3> <p>设计师在出设计稿的时候，出的都是二倍图，也就是说如果在这个设计稿上有一个宽高为200px的盒子，那么它最终画到页面上实际上是一个宽高为100px的盒子，那么再换算成rpx需要乘以2，就又变成了200rpx，跟设计稿上的数字是一样的，所以我们可以保持数字不变，直接将单位 px 替换成 rpx</p> <h3 id="选择器"><a href="#选择器" class="header-anchor">#</a> 选择器</h3> <p>目前支持的选择器如表所示</p> <table><thead><tr><th style="text-align:left;"><strong>类型</strong></th> <th style="text-align:left;"><strong>选择器</strong></th> <th style="text-align:left;"><strong>样例</strong></th> <th style="text-align:left;"><strong>样例描述</strong></th></tr></thead> <tbody><tr><td style="text-align:left;">类选择器</td> <td style="text-align:left;">.class</td> <td style="text-align:left;">.intro</td> <td style="text-align:left;">选择所有拥有 class=&quot;intro&quot; 的组件</td></tr> <tr><td style="text-align:left;">id选择器</td> <td style="text-align:left;">#id</td> <td style="text-align:left;">#firstname</td> <td style="text-align:left;">选择拥有 id=&quot;firstname&quot; 的组件</td></tr> <tr><td style="text-align:left;">元素选择器</td> <td style="text-align:left;">element</td> <td style="text-align:left;">view checkbox</td> <td style="text-align:left;">选择所有文档的 view 组件和所有的 checkbox 组件</td></tr> <tr><td style="text-align:left;">伪元素选择器</td> <td style="text-align:left;">::after</td> <td style="text-align:left;">view::after</td> <td style="text-align:left;">在 view 组件后边插入内容</td></tr> <tr><td style="text-align:left;">伪元素选择器</td> <td style="text-align:left;">::before</td> <td style="text-align:left;">view::before</td> <td style="text-align:left;">在 view 组件前边插入内容</td></tr></tbody></table> <h2 id="js-逻辑交互"><a href="#js-逻辑交互" class="header-anchor">#</a> JS 逻辑交互</h2> <p>跟web里的js没多大区别</p> <p>你还可以在 JS 中调用小程序提供的丰富的 API，利用这些 API 可以很方便的调起微信提供的能力，例如获取用户信息、本地存储、微信支付等。</p> <p>在前边的 QuickStart 例子中，在 <code>pages/index/index.js</code> 就调用了 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/user-info/wx.getUserInfo.html" target="_blank" rel="noopener noreferrer">wx.getUserInfo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 获取微信用户的头像和昵称，最后通过 <code>setData</code> 把获取到的信息显示到界面上。更多 API 可以参考文档 <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/api.html" target="_blank" rel="noopener noreferrer">小程序的API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。</p> <h3 id="数据绑定"><a href="#数据绑定" class="header-anchor">#</a> 数据绑定</h3> <p>跟vue一样可以用插值符号<code>{{}}</code></p> <p>但不同的是wx可以直接用插值改变属性的值，而vue必须用v-bind</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 正确的写法 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">data-test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{test}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> hello world<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>


<span class="token comment">&lt;!-- 错误的写法  --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">data-test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>{{test}}</span><span class="token punctuation">&gt;</span></span> hello world <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span> <span class="token punctuation">&gt;</span></span>
</code></pre></div><p>没有被定义的变量的或者是被设置为 undefined 的变量不会被同步到 wxml 中</p> <p>条件渲染跟vue类似，无非是改了一个前缀</p> <h3 id="列表渲染"><a href="#列表渲染" class="header-anchor">#</a> 列表渲染</h3> <p>在组件上使用 wx:for 控制属性绑定一个数组</p> <p>默认数组的当前项的下标变量名默认为 index，数组当前项的变量名默认为 item</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- array 是一个数组 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{array}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  {{index}}: {{item.message}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 对应的脚本文件
Page({
  data: {
    array: [{
      message: 'foo',
    }, {
      message: 'bar'
    }]
  }
})
--&gt;</span>
</code></pre></div><p>index和item直接默认就可以使用，当然也可以自定义，但感觉大多数情况下并没有这个必要。</p> <p>使用 wx:for-item 指定数组当前元素的变量名，使用 wx:for-index 指定数组当前下标的变量名：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{array}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for-index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>idx<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>itemName<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  {{idx}}: {{itemName.message}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>其中<strong>wx:key</strong>的作用大抵也是类似的。</p> <h2 id="程序与页面"><a href="#程序与页面" class="header-anchor">#</a> 程序与页面</h2> <h3 id="程序构造器app"><a href="#程序构造器app" class="header-anchor">#</a> 程序构造器App()</h3> <p>宿主环境提供了 App() 构造器用来注册一个程序App，需要留意的是App() 构造器必须写在项目根目录的app.js里，App实例是单例对象，在其他JS脚本中可以使用宿主环境提供的 getApp() 来获取程序实例。
代码清单3-3 getApp() 获取App实例</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// other.js</span>
<span class="token keyword">var</span> appInstance <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onLaunch</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onShow</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onHide</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onError</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  globalData<span class="token operator">:</span> <span class="token string">'I am global data'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>表3-1 App构造器的参数</p> <table><thead><tr><th style="text-align:left;">参数属性</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">onLaunch</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">当小程序初始化完成时，会触发 onLaunch（全局<strong>只触发一次</strong>）</td></tr> <tr><td style="text-align:left;">onShow</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">当小程序启动，或从后台进入前台显示，会触发 onShow</td></tr> <tr><td style="text-align:left;">onHide</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">当小程序从前台进入后台，会触发 onHide</td></tr> <tr><td style="text-align:left;">onError</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">当小程序发生脚本错误，或者 API 调用失败时，会触发 onError 并带上错误信息</td></tr> <tr><td style="text-align:left;">其他字段</td> <td style="text-align:left;">任意</td> <td style="text-align:left;">可以添加任意的函数或数据到 Object 参数中，在App实例回调用 this 可以访问</td></tr></tbody></table> <p>onLaunch全局只触发一次，onShow<strong>第一次加载</strong>的时候和每次被激活的时候出发，</p> <h3 id="全局数据"><a href="#全局数据" class="header-anchor">#</a> 全局数据</h3> <ul><li>所有页面的js都运行在同一个JsCore线程中，所以要手动清理setTimeout或者setInterval的定时器</li> <li>App实例是单例，所以这个实例下的属性都是共享的，</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// app.js</span>
<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  globalData<span class="token operator">:</span> <span class="token string">'I am global data'</span> <span class="token comment">// 全局共享数据</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 其他页面脚本other.js</span>
<span class="token keyword">var</span> appInstance <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>appInstance<span class="token punctuation">.</span>globalData<span class="token punctuation">)</span> <span class="token comment">// 输出: I am global data</span>
</code></pre></div><h3 id="页面构成"><a href="#页面构成" class="header-anchor">#</a> 页面构成</h3> <p>一个小程序可以有很多页面，每个页面承载不同的功能，页面之间可以互相跳转</p> <p>一个页面是分<strong>三部分</strong>组成：界面、配置和逻辑。界面由WXML文件和WXSS文件来负责描述，配置由JSON文件进行描述，页面逻辑则是由JS脚本文件负责</p> <p>一个页面的文件需要放置在<strong>同一个目录</strong>下，其中WXML文件和JS文件是必须存在的，JSON和WXSS文件是可选的。</p> <p>页面路径需要在小程序代码根目录app.json中的<strong>pages字段声明</strong>，<strong>否则</strong>这个页面不会被注册到宿主环境中</p> <h3 id="页面构造器page"><a href="#页面构造器page" class="header-anchor">#</a> 页面构造器Page()</h3> <p>宿主环境提供了 Page() 构造器用来注册一个小程序页面，接受一个Object参数</p> <table><thead><tr><th style="text-align:left;">参数属性</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">描述</th></tr></thead> <tbody><tr><td style="text-align:left;">data</td> <td style="text-align:left;">Object</td> <td style="text-align:left;">页面的初始数据</td></tr> <tr><td style="text-align:left;">onLoad</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">生命周期函数--监听页面加载，触发时机早于onShow和onReady</td></tr> <tr><td style="text-align:left;">onReady</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">生命周期函数--监听页面初次渲染完成</td></tr> <tr><td style="text-align:left;">onShow</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">生命周期函数--监听页面显示，触发事件早于onReady</td></tr> <tr><td style="text-align:left;">onHide</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">生命周期函数--监听页面隐藏</td></tr> <tr><td style="text-align:left;">onUnload</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">生命周期函数--监听页面卸载</td></tr> <tr><td style="text-align:left;">onPullDownRefresh</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">页面相关事件处理函数--监听用户下拉动作</td></tr> <tr><td style="text-align:left;">onReachBottom</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">页面上拉触底事件的处理函数</td></tr> <tr><td style="text-align:left;">onShareAppMessage</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">用户点击右上角转发</td></tr> <tr><td style="text-align:left;">onPageScroll</td> <td style="text-align:left;">Function</td> <td style="text-align:left;">页面滚动触发事件的处理函数</td></tr> <tr><td style="text-align:left;">其他</td> <td style="text-align:left;">Any</td> <td style="text-align:left;">可以添加任意的函数或数据，在Page实例的其他函数中用 this 可以访问</td></tr></tbody></table> <p>onLoad类似于vue的created，数据准备好了但dom还没渲染，onLoad在页面没被销毁之前只会触发1次</p> <p>onReady类似于mounted，onReady在页面没被销毁前只会触发1次</p> <p>onLoad早于 onShow，<strong>onShow早于onReady</strong></p> <h3 id="页面的数据"><a href="#页面的数据" class="header-anchor">#</a> 页面的数据</h3> <p>data参数是页面第一次渲染时从逻辑层传递到渲染层的数据，我们可以在Page实例下的方法调用this.setData把数据传递给渲染层，从而达到更新界面的目的。</p> <p>setData传递数据实际是一个异步的过程，所以setData的第二个参数是一个callback回调</p> <p>此外需要注意以下3点：</p> <ol><li>直接修改 Page实例的this.data 而不调用 this.setData 是无法改变页面的状态的，还会造成数据不一致。</li> <li>由于setData是需要两个线程的一些通信消耗，为了提高性能，每次设置的数据不应超过1024kB。</li> <li>不要把data中的任意一项的value设为undefined，否则可能会有引起一些不可预料的bug。</li></ol> <h3 id="页面的用户行为"><a href="#页面的用户行为" class="header-anchor">#</a> 页面的用户行为</h3> <p>小程序宿主环境提供了四个和页面相关的用户行为回调：</p> <ol><li><p>下拉刷新 onPullDownRefresh
监听用户下拉刷新事件，需要在app.json的window选项中或页面配置page.json中设置enablePullDownRefresh为true。当处理完数据刷新后，wx.stopPullDownRefresh可以停止当前页面的下拉刷新。</p></li> <li><p>上拉触底 onReachBottom
监听用户上拉触底事件。可以在app.json的window选项中或页面配置page.json中设置触发距离onReachBottomDistance。在触发距离内滑动期间，本事件只会被触发一次。</p></li> <li><p>页面滚动 onPageScroll
监听用户滑动页面事件，参数为 Object，包含 scrollTop 字段，表示页面在垂直方向已滚动的距离（单位px）。</p></li> <li><p>用户转发 onShareAppMessage
<strong>只有定义</strong>了此事件处理函数，右上角菜单<strong>才会显示</strong>“转发”按钮，在用户点击转发按钮的时候会调用，此事件需要return一个Object，包含title和path两个字段，用于自定义转发内容，如代码清单3-13所示。</p> <p>代码清单3-13 使用onShareAppMessage自定义转发字段</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// page.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token function-variable function">onShareAppMessage</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token punctuation">{</span>
   title<span class="token operator">:</span> <span class="token string">'自定义转发标题'</span><span class="token punctuation">,</span>
   path<span class="token operator">:</span> <span class="token string">'/page/user?id=123'</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <h3 id="页面跳转和路由"><a href="#页面跳转和路由" class="header-anchor">#</a> 页面跳转和路由</h3> <p>一个小程序拥有多个页面，我们可以通过wx.navigateTo推入一个新的页面，在首页使用2次wx.navigateTo后，页面层级会有三层，我们把这样的一个页面层级称为页面栈。目前最多可以到10层。</p> <p>使用 wx.navigateTo({ url: 'pageD' }) 可以往当前页面栈多推入一个 pageD，此时页面栈变成 [ pageA, pageB, pageC, pageD ]。
使用 wx.navigateBack() 可以退出当前页面栈的最顶上页面，此时页面栈变成 [ pageA, pageB, pageC ]。
使用wx.redirectTo({ url: 'pageE' }) 是替换当前页变成pageE，此时页面栈变成 [ pageA, pageB, pageE ]，当页面栈到达10层没法再新增的时候，往往就是使用redirectTo这个API进行页面跳转。</p> <hr></div></div></div> <div class="footer-wrap" data-v-e2e64d12><div class="footer page" data-v-e2e64d12><div class="count" data-v-e2e64d12>
      本站总访问量<span id="busuanzi_value_site_pv" data-v-e2e64d12></span>次
      本站访客数<span id="busuanzi_value_site_uv" data-v-e2e64d12></span>人次
      本文总阅读量<span id="busuanzi_value_page_pv" data-v-e2e64d12></span>次
    </div> <div class="link" data-v-e2e64d12><a href="http://www.aaronsw.com/" target="_blank" data-v-e2e64d12>Aaron Swartz</a><a href="https://www.cnblogs.com/rubylouvre/" target="_blank" data-v-e2e64d12>司徒正美</a></div> <div class="contact" data-v-e2e64d12><a href="https://github.com/KMSWoo" target="_blank" data-v-e2e64d12><span class="iconfont icon-github" data-v-e2e64d12></span></a> <a href="mailto:wayneincode@gmail.com" data-v-e2e64d12><span class="iconfont icon-youjian" data-v-e2e64d12></span></a></div></div></div></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.f6b2750d.js" defer></script><script src="/assets/js/6.992087fc.js" defer></script><script src="/assets/js/1.bd8257ab.js" defer></script><script src="/assets/js/82.3be4b911.js" defer></script>
  </body>
</html>
