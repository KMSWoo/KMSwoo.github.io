(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{697:function(t,a,s){"use strict";s.r(a);var e=s(47),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("关于微信小程序开发基础知识点的总结。")]),t._v(" "),s("h2",{attrs:{id:"小程序代码构成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小程序代码构成"}},[t._v("#")]),t._v(" 小程序代码构成")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v(".json")]),t._v(" 后缀的 "),s("code",[t._v("JSON")]),t._v(" 配置文件")])]),t._v(" "),s("li",[s("p",[s("code",[t._v(".wxml")]),t._v(" 后缀的 "),s("code",[t._v("WXML")]),t._v(" 模板文件")])]),t._v(" "),s("li",[s("p",[s("code",[t._v(".wxss")]),t._v(" 后缀的 "),s("code",[t._v("WXSS")]),t._v(" 样式文件")])]),t._v(" "),s("li",[s("p",[s("code",[t._v(".js")]),t._v(" 后缀的 "),s("code",[t._v("JS")]),t._v(" 脚本逻辑文件")])])]),t._v(" "),s("h2",{attrs:{id:"json-配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#json-配置"}},[t._v("#")]),t._v(" JSON 配置")]),t._v(" "),s("h3",{attrs:{id:"app-json"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#app-json"}},[t._v("#")]),t._v(" app.json")]),t._v(" "),s("p",[t._v("全局配置，包括了小程序的所有页面路径、界面表现、网络超时时间、底部 tab 等。")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pages"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pages/index/index"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pages/logs/logs"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"window"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"backgroundTextStyle"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"light"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"navigationBarBackgroundColor"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#fff"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"navigationBarTitleText"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Weixin"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"navigationBarTextStyle"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"black"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ol",[s("li",[s("code",[t._v("pages")]),t._v("字段 —— 用于描述当前小程序所有页面路径，这是为了让微信客户端知道当前你的小程序页面定义在哪个目录。")]),t._v(" "),s("li",[s("code",[t._v("window")]),t._v("字段 —— 定义小程序所有页面的顶部背景颜色，文字颜色定义等。")])]),t._v(" "),s("h3",{attrs:{id:"工具配置-project-config-json"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#工具配置-project-config-json"}},[t._v("#")]),t._v(" 工具配置 project.config.json")]),t._v(" "),s("p",[t._v("开发者工具的一些个性化配置，方便迅速还原开发现场。其他配置项细节可以参考文档 "),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/devtools/projectconfig.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("开发者工具的配置"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"页面配置-page-json"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#页面配置-page-json"}},[t._v("#")]),t._v(" 页面配置 page.json")]),t._v(" "),s("p",[t._v("pages目录下每一个page文件夹下对应的json配置文件，比如index.json，logs.json。")]),t._v(" "),s("p",[t._v("作用是用来个性化每个页面的配置，会覆盖全局配置。")]),t._v(" "),s("h2",{attrs:{id:"wxml-模板"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wxml-模板"}},[t._v("#")]),t._v(" WXML 模板")]),t._v(" "),s("p",[t._v("本质上就是封装的组件")]),t._v(" "),s("p",[t._v("更多详细的组件讲述参考下个章节 "),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/framework.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("小程序的能力"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"wxss-样式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wxss-样式"}},[t._v("#")]),t._v(" WXSS 样式")]),t._v(" "),s("p",[s("code",[t._v("WXSS")]),t._v(" 具有 "),s("code",[t._v("CSS")]),t._v(" 大部分的特性，小程序在 "),s("code",[t._v("WXSS")]),t._v(" 也做了一些扩充和修改。")]),t._v(" "),s("ol",[s("li",[t._v("新增了尺寸单位。在写 "),s("code",[t._v("CSS")]),t._v(" 样式时，开发者需要考虑到手机设备的屏幕会有不同的宽度和设备像素比，采用一些技巧来换算一些像素单位。"),s("code",[t._v("WXSS")]),t._v(" 在底层支持"),s("strong",[t._v("新的尺寸单位")]),t._v(" "),s("code",[t._v("rpx")]),t._v(" ，开发者可以免去换算的烦恼，只要交给小程序底层来换算即可，由于换算采用的"),s("strong",[t._v("浮点数运算")]),t._v("，所以运算结果会和预期结果有一点点偏差。")]),t._v(" "),s("li",[t._v("提供了全局的样式和局部样式。和前边 "),s("code",[t._v("app.json")]),t._v(", "),s("code",[t._v("page.json")]),t._v(" 的概念相同，你可以写一个 "),s("code",[t._v("app.wxss")]),t._v(" 作为全局样式，会作用于当前小程序的所有页面，局部页面样式 "),s("code",[t._v("page.wxss")]),t._v(" 仅对当前页面生效。")]),t._v(" "),s("li",[t._v("此外 "),s("code",[t._v("WXSS")]),t._v(" 仅支持部分 "),s("code",[t._v("CSS")]),t._v(" 选择器")])]),t._v(" "),s("p",[t._v("更详细的文档可以参考 "),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxss.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("WXSS"),s("OutboundLink")],1),t._v(" 。")]),t._v(" "),s("h3",{attrs:{id:"rpx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rpx"}},[t._v("#")]),t._v(" rpx")]),t._v(" "),s("p",[t._v("在WXSS中，引入了rpx（responsive pixel）尺寸单位。引用新尺寸单位的目的是，适配不同宽度的屏幕，开发起来更简单。")]),t._v(" "),s("p",[t._v("小程序编译后，rpx会做一次px换算。换算是以375个物理像素为基准，也就是在一个宽度为375物理像素的屏幕下，1rpx = 1px。")]),t._v(" "),s("p",[t._v("举个例子：iPhone6屏幕宽度为375px，共750个物理像素，那么1rpx = 375 / 750 px = 0.5px。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("设备")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("rpx换算px (屏幕宽度/750)")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("px换算rpx (750/屏幕宽度)")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("iPhone5")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1rpx = 0.42px")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1px = 2.34rpx")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("iPhone6")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1rpx = 0.5px")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1px = 2.00rpx")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("iPhone6s")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1rpx = 0.552px")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1px = 1.81rpx")])])])]),t._v(" "),s("h3",{attrs:{id:"rpx-和-iphone-设计稿的关系"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rpx-和-iphone-设计稿的关系"}},[t._v("#")]),t._v(" rpx 和 iPhone 设计稿的关系")]),t._v(" "),s("blockquote",[s("p",[t._v("官方建议：开发微信小程序时，设计师可以以iPhone6 作为视觉稿的标准，如果要根据iPhone6的设计稿，绘制小程序的页面，可以直接把单位 px 替换成 rpx 。例如：假设iPhone6设计稿上，要绘制一个宽高为 200px 的盒子，换算为 rpx为200rpx")])]),t._v(" "),s("h3",{attrs:{id:"以iphone6为设计稿标准-单位-px-直接替换成-rpx的原因"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#以iphone6为设计稿标准-单位-px-直接替换成-rpx的原因"}},[t._v("#")]),t._v(" 以iPhone6为设计稿标准，单位 px 直接替换成 rpx的原因")]),t._v(" "),s("p",[t._v("设计师在出设计稿的时候，出的都是二倍图，也就是说如果在这个设计稿上有一个宽高为200px的盒子，那么它最终画到页面上实际上是一个宽高为100px的盒子，那么再换算成rpx需要乘以2，就又变成了200rpx，跟设计稿上的数字是一样的，所以我们可以保持数字不变，直接将单位 px 替换成 rpx")]),t._v(" "),s("h3",{attrs:{id:"选择器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#选择器"}},[t._v("#")]),t._v(" 选择器")]),t._v(" "),s("p",[t._v("目前支持的选择器如表所示")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("类型")])]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("选择器")])]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("样例")])]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[s("strong",[t._v("样例描述")])])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("类选择器")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v(".class")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v(".intro")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v('选择所有拥有 class="intro" 的组件')])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("id选择器")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("#id")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("#firstname")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v('选择拥有 id="firstname" 的组件')])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("元素选择器")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("element")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("view checkbox")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("选择所有文档的 view 组件和所有的 checkbox 组件")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("伪元素选择器")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("::after")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("view::after")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("在 view 组件后边插入内容")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("伪元素选择器")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("::before")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("view::before")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("在 view 组件前边插入内容")])])])]),t._v(" "),s("h2",{attrs:{id:"js-逻辑交互"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#js-逻辑交互"}},[t._v("#")]),t._v(" JS 逻辑交互")]),t._v(" "),s("p",[t._v("跟web里的js没多大区别")]),t._v(" "),s("p",[t._v("你还可以在 JS 中调用小程序提供的丰富的 API，利用这些 API 可以很方便的调起微信提供的能力，例如获取用户信息、本地存储、微信支付等。")]),t._v(" "),s("p",[t._v("在前边的 QuickStart 例子中，在 "),s("code",[t._v("pages/index/index.js")]),t._v(" 就调用了 "),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/open-api/user-info/wx.getUserInfo.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("wx.getUserInfo"),s("OutboundLink")],1),t._v(" 获取微信用户的头像和昵称，最后通过 "),s("code",[t._v("setData")]),t._v(" 把获取到的信息显示到界面上。更多 API 可以参考文档 "),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/api.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("小程序的API"),s("OutboundLink")],1),t._v(" 。")]),t._v(" "),s("h3",{attrs:{id:"数据绑定"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据绑定"}},[t._v("#")]),t._v(" 数据绑定")]),t._v(" "),s("p",[t._v("跟vue一样可以用插值符号"),s("code",[t._v("{{}}")])]),t._v(" "),s("p",[t._v("但不同的是wx可以直接用插值改变属性的值，而vue必须用v-bind")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 正确的写法 --\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("text")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("data-test")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("{{test}}"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" hello world"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("text")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 错误的写法  --\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("text")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("data-test")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),t._v("{{test}}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" hello world "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("text")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("没有被定义的变量的或者是被设置为 undefined 的变量不会被同步到 wxml 中")]),t._v(" "),s("p",[t._v("条件渲染跟vue类似，无非是改了一个前缀")]),t._v(" "),s("h3",{attrs:{id:"列表渲染"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#列表渲染"}},[t._v("#")]),t._v(" 列表渲染")]),t._v(" "),s("p",[t._v("在组件上使用 wx:for 控制属性绑定一个数组")]),t._v(" "),s("p",[t._v("默认数组的当前项的下标变量名默认为 index，数组当前项的变量名默认为 item")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- array 是一个数组 --\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("wx:")]),t._v("for")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("{{array}}"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  {{index}}: {{item.message}}\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("view")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 对应的脚本文件\nPage({\n  data: {\n    array: [{\n      message: 'foo',\n    }, {\n      message: 'bar'\n    }]\n  }\n})\n--\x3e")]),t._v("\n")])])]),s("p",[t._v("index和item直接默认就可以使用，当然也可以自定义，但感觉大多数情况下并没有这个必要。")]),t._v(" "),s("p",[t._v("使用 wx:for-item 指定数组当前元素的变量名，使用 wx:for-index 指定数组当前下标的变量名：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("wx:")]),t._v("for")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("{{array}}"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("wx:")]),t._v("for-index")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("idx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("wx:")]),t._v("for-item")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("itemName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  {{idx}}: {{itemName.message}}\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("view")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("其中"),s("strong",[t._v("wx:key")]),t._v("的作用大抵也是类似的。")]),t._v(" "),s("h2",{attrs:{id:"程序与页面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#程序与页面"}},[t._v("#")]),t._v(" 程序与页面")]),t._v(" "),s("h3",{attrs:{id:"程序构造器app"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#程序构造器app"}},[t._v("#")]),t._v(" 程序构造器App()")]),t._v(" "),s("p",[t._v("宿主环境提供了 App() 构造器用来注册一个程序App，需要留意的是App() 构造器必须写在项目根目录的app.js里，App实例是单例对象，在其他JS脚本中可以使用宿主环境提供的 getApp() 来获取程序实例。\n代码清单3-3 getApp() 获取App实例")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// other.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" appInstance "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getApp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("App")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onLaunch")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onShow")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onHide")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onError")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("msg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  globalData"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'I am global data'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("表3-1 App构造器的参数")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("参数属性")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onLaunch")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("当小程序初始化完成时，会触发 onLaunch（全局"),s("strong",[t._v("只触发一次")]),t._v("）")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onShow")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("当小程序启动，或从后台进入前台显示，会触发 onShow")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onHide")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("当小程序从前台进入后台，会触发 onHide")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onError")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("当小程序发生脚本错误，或者 API 调用失败时，会触发 onError 并带上错误信息")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("其他字段")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("任意")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("可以添加任意的函数或数据到 Object 参数中，在App实例回调用 this 可以访问")])])])]),t._v(" "),s("p",[t._v("onLaunch全局只触发一次，onShow"),s("strong",[t._v("第一次加载")]),t._v("的时候和每次被激活的时候出发，")]),t._v(" "),s("h3",{attrs:{id:"全局数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全局数据"}},[t._v("#")]),t._v(" 全局数据")]),t._v(" "),s("ul",[s("li",[t._v("所有页面的js都运行在同一个JsCore线程中，所以要手动清理setTimeout或者setInterval的定时器")]),t._v(" "),s("li",[t._v("App实例是单例，所以这个实例下的属性都是共享的，")])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// app.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("App")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  globalData"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'I am global data'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 全局共享数据")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 其他页面脚本other.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" appInstance "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getApp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("appInstance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("globalData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 输出: I am global data")]),t._v("\n")])])]),s("h3",{attrs:{id:"页面构成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#页面构成"}},[t._v("#")]),t._v(" 页面构成")]),t._v(" "),s("p",[t._v("一个小程序可以有很多页面，每个页面承载不同的功能，页面之间可以互相跳转")]),t._v(" "),s("p",[t._v("一个页面是分"),s("strong",[t._v("三部分")]),t._v("组成：界面、配置和逻辑。界面由WXML文件和WXSS文件来负责描述，配置由JSON文件进行描述，页面逻辑则是由JS脚本文件负责")]),t._v(" "),s("p",[t._v("一个页面的文件需要放置在"),s("strong",[t._v("同一个目录")]),t._v("下，其中WXML文件和JS文件是必须存在的，JSON和WXSS文件是可选的。")]),t._v(" "),s("p",[t._v("页面路径需要在小程序代码根目录app.json中的"),s("strong",[t._v("pages字段声明")]),t._v("，"),s("strong",[t._v("否则")]),t._v("这个页面不会被注册到宿主环境中")]),t._v(" "),s("h3",{attrs:{id:"页面构造器page"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#页面构造器page"}},[t._v("#")]),t._v(" 页面构造器Page()")]),t._v(" "),s("p",[t._v("宿主环境提供了 Page() 构造器用来注册一个小程序页面，接受一个Object参数")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("参数属性")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("data")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Object")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("页面的初始数据")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onLoad")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("生命周期函数--监听页面加载，触发时机早于onShow和onReady")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onReady")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("生命周期函数--监听页面初次渲染完成")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onShow")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("生命周期函数--监听页面显示，触发事件早于onReady")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onHide")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("生命周期函数--监听页面隐藏")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onUnload")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("生命周期函数--监听页面卸载")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onPullDownRefresh")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("页面相关事件处理函数--监听用户下拉动作")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onReachBottom")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("页面上拉触底事件的处理函数")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onShareAppMessage")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("用户点击右上角转发")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("onPageScroll")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("页面滚动触发事件的处理函数")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("其他")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Any")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("可以添加任意的函数或数据，在Page实例的其他函数中用 this 可以访问")])])])]),t._v(" "),s("p",[t._v("onLoad类似于vue的created，数据准备好了但dom还没渲染，onLoad在页面没被销毁之前只会触发1次")]),t._v(" "),s("p",[t._v("onReady类似于mounted，onReady在页面没被销毁前只会触发1次")]),t._v(" "),s("p",[t._v("onLoad早于 onShow，"),s("strong",[t._v("onShow早于onReady")])]),t._v(" "),s("h3",{attrs:{id:"页面的数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#页面的数据"}},[t._v("#")]),t._v(" 页面的数据")]),t._v(" "),s("p",[t._v("data参数是页面第一次渲染时从逻辑层传递到渲染层的数据，我们可以在Page实例下的方法调用this.setData把数据传递给渲染层，从而达到更新界面的目的。")]),t._v(" "),s("p",[t._v("setData传递数据实际是一个异步的过程，所以setData的第二个参数是一个callback回调")]),t._v(" "),s("p",[t._v("此外需要注意以下3点：")]),t._v(" "),s("ol",[s("li",[t._v("直接修改 Page实例的this.data 而不调用 this.setData 是无法改变页面的状态的，还会造成数据不一致。")]),t._v(" "),s("li",[t._v("由于setData是需要两个线程的一些通信消耗，为了提高性能，每次设置的数据不应超过1024kB。")]),t._v(" "),s("li",[t._v("不要把data中的任意一项的value设为undefined，否则可能会有引起一些不可预料的bug。")])]),t._v(" "),s("h3",{attrs:{id:"页面的用户行为"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#页面的用户行为"}},[t._v("#")]),t._v(" 页面的用户行为")]),t._v(" "),s("p",[t._v("小程序宿主环境提供了四个和页面相关的用户行为回调：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("下拉刷新 onPullDownRefresh\n监听用户下拉刷新事件，需要在app.json的window选项中或页面配置page.json中设置enablePullDownRefresh为true。当处理完数据刷新后，wx.stopPullDownRefresh可以停止当前页面的下拉刷新。")])]),t._v(" "),s("li",[s("p",[t._v("上拉触底 onReachBottom\n监听用户上拉触底事件。可以在app.json的window选项中或页面配置page.json中设置触发距离onReachBottomDistance。在触发距离内滑动期间，本事件只会被触发一次。")])]),t._v(" "),s("li",[s("p",[t._v("页面滚动 onPageScroll\n监听用户滑动页面事件，参数为 Object，包含 scrollTop 字段，表示页面在垂直方向已滚动的距离（单位px）。")])]),t._v(" "),s("li",[s("p",[t._v("用户转发 onShareAppMessage\n"),s("strong",[t._v("只有定义")]),t._v("了此事件处理函数，右上角菜单"),s("strong",[t._v("才会显示")]),t._v("“转发”按钮，在用户点击转发按钮的时候会调用，此事件需要return一个Object，包含title和path两个字段，用于自定义转发内容，如代码清单3-13所示。")]),t._v(" "),s("p",[t._v("代码清单3-13 使用onShareAppMessage自定义转发字段")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// page.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Page")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onShareAppMessage")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   title"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'自定义转发标题'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/page/user?id=123'")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),s("h3",{attrs:{id:"页面跳转和路由"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#页面跳转和路由"}},[t._v("#")]),t._v(" 页面跳转和路由")]),t._v(" "),s("p",[t._v("一个小程序拥有多个页面，我们可以通过wx.navigateTo推入一个新的页面，在首页使用2次wx.navigateTo后，页面层级会有三层，我们把这样的一个页面层级称为页面栈。目前最多可以到10层。")]),t._v(" "),s("p",[t._v("使用 wx.navigateTo({ url: 'pageD' }) 可以往当前页面栈多推入一个 pageD，此时页面栈变成 [ pageA, pageB, pageC, pageD ]。\n使用 wx.navigateBack() 可以退出当前页面栈的最顶上页面，此时页面栈变成 [ pageA, pageB, pageC ]。\n使用wx.redirectTo({ url: 'pageE' }) 是替换当前页变成pageE，此时页面栈变成 [ pageA, pageB, pageE ]，当页面栈到达10层没法再新增的时候，往往就是使用redirectTo这个API进行页面跳转。")]),t._v(" "),s("hr")])}),[],!1,null,null,null);a.default=n.exports}}]);