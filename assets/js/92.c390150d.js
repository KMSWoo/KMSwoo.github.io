(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{703:function(s,t,e){"use strict";e.r(t);var r=e(47),n=Object(r.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("Browserslist是一个前端项目配置工具，功能是在前端工具之间共享目标环境的浏览器信息。")]),s._v(" "),e("h2",{attrs:{id:"概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[s._v("#")]),s._v(" 概述")]),s._v(" "),e("p",[s._v("在现代前端项目中，我们会使用 Babel 来转换 ES6 语法、使用 AutoPrefixer, PostCSS 来转换 CSSNext 语法、使用 ESLint 来保证代码质量和规范。所以一般在前端项目中会使用下面常用的工具：")]),s._v(" "),e("ul",[e("li",[e("strong",[e("a",{attrs:{href:"https://github.com/postcss/autoprefixer",target:"_blank",rel:"noopener noreferrer"}},[s._v("Autoprefixer"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("strong",[e("a",{attrs:{href:"https://babeljs.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Babel"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("strong",[e("a",{attrs:{href:"https://github.com/csstools/postcss-preset-env",target:"_blank",rel:"noopener noreferrer"}},[s._v("postcss-preset-env"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("strong",[e("a",{attrs:{href:"https://github.com/csstools/postcss-normalize",target:"_blank",rel:"noopener noreferrer"}},[s._v("postcss-normalize"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("strong",[s._v("ESLint 的 "),e("a",{attrs:{href:"https://github.com/eslint/eslint",target:"_blank",rel:"noopener noreferrer"}},[s._v("eslint-plugin-compat"),e("OutboundLink")],1)])]),s._v(" "),e("li",[e("strong",[s._v("Stylelint 的 "),e("a",{attrs:{href:"https://github.com/ismay/stylelint-no-unsupported-browser-features",target:"_blank",rel:"noopener noreferrer"}},[s._v("stylelint-no-unsupported-browser-features"),e("OutboundLink")],1)])])]),s._v(" "),e("p",[s._v("这些工具会根据配置的目标浏览器环境来决定使用那些策略来处理你的源代码。")]),s._v(" "),e("p",[s._v("例如，如果你仅支持 Edge 15, 那么 Babel 不会对 "),e("code",[s._v("const str =")]),s._v("hello world``进行转换，但是如果要支持 IE 10 那么 Babel 就会把其转换成 "),e("code",[s._v('var str = "hello world";')]),s._v("。")]),s._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"babel"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"presets"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"env"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"targets"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"browsers"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Edge 15"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),e("p",[s._v("Babel 在转换时会根据目标浏览器信息加入特殊的 Plugins 或 Polyfills，同样 "),e("strong",[e("a",{attrs:{href:"https://github.com/postcss/autoprefixer",target:"_blank",rel:"noopener noreferrer"}},[s._v("Autoprefixer"),e("OutboundLink")],1)]),s._v(" ，"),e("strong",[e("a",{attrs:{href:"https://github.com/csstools/postcss-preset-env",target:"_blank",rel:"noopener noreferrer"}},[s._v("postcss-preset-env"),e("OutboundLink")],1)]),s._v(" ，"),e("strong",[e("a",{attrs:{href:"https://github.com/csstools/postcss-normalize",target:"_blank",rel:"noopener noreferrer"}},[s._v("postcss-normalize"),e("OutboundLink")],1)]),s._v(" ，"),e("strong",[s._v("ESLint 的 "),e("a",{attrs:{href:"https://github.com/eslint/eslint",target:"_blank",rel:"noopener noreferrer"}},[s._v("eslint-plugin-compat"),e("OutboundLink")],1)]),s._v(" ，**Stylelint 的 "),e("a",{attrs:{href:"https://github.com/ismay/stylelint-no-unsupported-browser-features",target:"_blank",rel:"noopener noreferrer"}},[s._v("stylelint-no-unsupported-browser-features "),e("OutboundLink")],1),s._v("**工具也提供同样的配置。")]),s._v(" "),e("p",[s._v("但所有这样工具都有自己的配置信息，这样很可能会导致工具之间读取的配置信息是不一致的。")]),s._v(" "),e("h2",{attrs:{id:"使用方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用方法"}},[s._v("#")]),s._v(" 使用方法")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/ai/browserslist",target:"_blank",rel:"noopener noreferrer"}},[s._v("Browserslist"),e("OutboundLink")],1),s._v(" 的出现就是为了解决工具之间各自为战的情况，可以提供统一的配置。即共享项目中的目标浏览器环境信息。")]),s._v(" "),e("p",[s._v("Browserslists 通过向 "),e("a",{attrs:{href:"https://caniuse.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("caniuse"),e("OutboundLink")],1),s._v(" 传递查询字符串（queries）来获取目标环境信息，这些 queries 可写在下面两个文件中，即 Browserslists 提供两种配置方法。（其实还有其它配置方法，可参考文档）。")]),s._v(" "),e("ul",[e("li",[e("code",[s._v(".browserslistrc")]),s._v(" 文件")])]),s._v(" "),e("p",[s._v("在项目中添加一个"),e("code",[s._v(".browserlistrc")]),s._v("文件来配置, 每一行都是一个 query, "),e("code",[s._v("#")]),s._v(" 用来注释。")]),s._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[s._v("# Browsers that we support\n\nlast "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" version\n> "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("%\nnot dead\n")])])]),e("ul",[e("li",[s._v("通过 "),e("code",[s._v("package.json")]),s._v(" 文件")])]),s._v(" "),e("p",[s._v("在项目中的 "),e("code",[s._v("package.json")]),s._v("文件中添加一个 "),e("code",[s._v("broserslist")]),s._v(" 项也可以完成配置，每一个元素都是一个 query。")]),s._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"private"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"browserslist"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"last 1 version"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"> 1%"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"not dead"')]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),e("p",[s._v("上面两种配置方法效果是一样的，那么通过上面的配置后，我们的项目的目标浏览器环境是什么那？通过 "),e("code",[s._v("npx browserslist")]),s._v("可以查看：")]),s._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[s._v("$ npx browserslist\nand_chr "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("70")]),s._v("\nand_ff "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v("\nand_qq "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.2")]),s._v("\nand_uc "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("11.8")]),s._v("\nandroid "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("67")]),s._v("\nbaidu "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.12")]),s._v("\nchrome "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("71")]),s._v("\nchrome "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("70")]),s._v("\nchrome "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("69")]),s._v("\nedge "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("\nedge "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v("\nfirefox "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\nfirefox "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("63")]),s._v("\nie "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("\nie_mob "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("\nios_saf "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12.0")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("-12.1")]),s._v("\nios_saf "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("11.3")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("-11.4")]),s._v("\nop_mini all\nop_mob "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("46")]),s._v("\nopera "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("57")]),s._v("\nsafari "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("\n")])])]),e("h4",{attrs:{id:"queries"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#queries"}},[s._v("#")]),s._v(" Queries")]),s._v(" "),e("ol",[e("li",[s._v("query 字符串不区分大小写。")]),s._v(" "),e("li",[s._v("如果没有 query 字符串，则会使用默认的 defaults 字符串，其代表的 queries 是："),e("code",[s._v("> 0.5%, last 2 versions, Firefox ESR, not dead")]),s._v(".")])]),s._v(" "),e("p",[s._v("上面例子中的 queries：")]),s._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"last 1 version"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"> 1%"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"not dead"')]),s._v("\n")])])]),e("p",[s._v("是什么意思那？解释如下：")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("last 1 version")]),s._v(" : 即支持各类浏览器最近的一个版本，当然这里的 1 是可变的数字。")]),s._v(" "),e("li",[e("code",[s._v("1%")]),s._v(" : 支持市场份额大于 1% 的浏览器。")]),s._v(" "),e("li",[e("code",[s._v("not dead")]),s._v(": 这个 query 中 "),e("code",[s._v("not")]),s._v(" 是"),e("strong",[s._v("逻辑非")]),s._v("操作符，即对 "),e("code",[s._v("dead")]),s._v("取反，而浏览器被认为是 "),e("code",[s._v("dead")]),s._v(" 条件是：最新的两个版本中发现其市场份额已经低于 0.5% 并且 24 个月内没有任务官方支持和更新了。")])]),s._v(" "),e("p",[e("em",[s._v("not")]),s._v(" 也 queries 中惟一一个操作符，可以用在任何 query 前。")]),s._v(" "),e("p",[s._v("Browserslist 支持更完善的 queries 请参考"),e("a",{attrs:{href:"https://github.com/browserslist/browserslist#full-list",target:"_blank",rel:"noopener noreferrer"}},[s._v("文档"),e("OutboundLink")],1),s._v("。")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("dead")]),s._v(": 意思是已经24个月没有得到官方更新或者维护支持，目前有IE 10"),e("code",[s._v(",")]),s._v("IE_Mob 11"),e("code",[s._v(",")]),s._v("BlackBerry 10"),e("code",[s._v(",")]),s._v("BlackBerry 7"),e("code",[s._v(",")]),s._v("Samsung 4"),e("code",[s._v("and")]),s._v("OperaMobile 12.1`.")])]),s._v(" "),e("h2",{attrs:{id:"最佳实践"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[s._v("#")]),s._v(" 最佳实践")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("直接选择支持的浏览器（如："),e("code",[s._v("last 2 Chrome versions")]),s._v("），如果你的项目仅支持某个浏览器。之前见过公司的内部系统仅支持 Chrome 浏览器，就可以使用这个 query 啦。")])]),s._v(" "),e("li",[e("p",[s._v("默认配置是"),e("code",[s._v("\\> 0.5%, last 2 versions, Firefox ESR, not dead")]),s._v("，如果要 Override 默认配置，推荐通过组合 "),e("code",[s._v("last 1 version")]),s._v(", "),e("code",[s._v("not dead")]),s._v(" , "),e("code",[s._v("> 0.2%")]),s._v(" (or "),e("code",[s._v("> 1% in US")]),s._v(", "),e("code",[s._v("> 1% in my stats")]),s._v("). 来实现。")])]),s._v(" "),e("li",[e("p",[s._v("不要删除你不了解的浏览器。Opera Mini 在非洲的用户超过 10 亿比 Edge 的全球市场份额还大。QQ 浏览器在中国的份额超过 Firefox 和 Safari 的总合。")])])]),s._v(" "),e("hr")])}),[],!1,null,null,null);t.default=n.exports}}]);